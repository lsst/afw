# -*- python -*-
import os

from lsst.sconsUtils import scripts, env, targets

afwdataDir = env.ProductDir("afwdata")

with open('test.txt', 'r') as f:
    tests = f.readlines()
pybind11_ported_tests = [t[6:].strip() for t in tests if not t.startswith('#')]

if not afwdataDir:
	testArgs = dict(statistics = "--run_test=!StatisticsTestImages", background = "--run_test=!BackgroundTestImages",)
	scripts.BasicSConscript.tests(pyList=pybind11_ported_tests, args=testArgs)
else:
	# copy AFWDATA_DIR to the test's environment
	env["ENV"]["AFWDATA_DIR"] = afwdataDir
	scripts.BasicSConscript.tests(pyList=pybind11_ported_tests)

env.Clean(targets["tests"], "#testTable.fits")
